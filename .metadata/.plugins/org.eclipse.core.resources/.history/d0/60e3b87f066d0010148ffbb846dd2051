package in.cfn.main.dao;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;
import in.cfn.main.SprongbootProject5JdbcCrudApplication;
import in.cfn.main.entity.User;

@Repository
public class UserDao {

	private final SprongbootProject5JdbcCrudApplication sprongbootProject5JdbcCrudApplication;

	@Autowired
	private JdbcTemplate jdbcTemplate;

	UserDao(SprongbootProject5JdbcCrudApplication sprongbootProject5JdbcCrudApplication) {
		this.sprongbootProject5JdbcCrudApplication = sprongbootProject5JdbcCrudApplication;
	}
//	JdbcTemplate provide method to interact with database.

//	INSERT METHOD
	public boolean insertUser(User user) {

		boolean status = false;

		try {

			String INSERT_SQL_QUERY = "INSERT INTO users(name, email, gender, city) VALUES (?,?,?,?)";

//			To INSERT,UPDATE,DELETE we use 'update' method.
			int count = jdbcTemplate.update(INSERT_SQL_QUERY, user.getName(), user.getEmail(), user.getGender(),
					user.getCity());

			if (count > 0) {
				status = true;
			} else {
				status = false;
			}

		} catch (Exception e) {
			status = false;
			e.printStackTrace();
		}

		return status;

	}

//	UPDATE METHOD
	public void updateUser(User user) {
		boolean status = false;
		try {

			String UPDATE_SQL_QUERY = "UPDATE users SET name=?, gender=?, city=? WHERE email=?";

			int count = jdbcTemplate.update(UPDATE_SQL_QUERY, user.getName(), user.getEmail(), user.getCity(),
					user.getEmail());

			if (count > 0) {
				status=true;
			}else {
				status=false;				
			}

		} catch (Exception e) {
			status=false;
			e.printStackTrace();
		}

	}

}
